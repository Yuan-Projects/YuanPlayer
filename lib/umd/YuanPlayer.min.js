!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).YuanPlayer=t()}(this,(function(){var e=function(t,s){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])},e(t,s)};function t(t,s){if("function"!=typeof s&&null!==s)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function r(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(r.prototype=s.prototype,new r)}var s=function(){return s=Object.assign||function(e){for(var t,s=1,r=arguments.length;s<r;s++)for(var n in t=arguments[s])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},s.apply(this,arguments)};function r(e,t,s){if(s||2===arguments.length)for(var r,n=0,i=t.length;n<i;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}function n(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}[Element.prototype,CharacterData.prototype,DocumentType.prototype].filter(Boolean).forEach((function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})}));var i=function(){return!!document.createElement("audio").play},o=function(){return!!document.createElement("video").play};function l(e){return"trunc"in Math?Math.trunc(e):e<0?Math.ceil(e):Math.floor(e)}function a(e,t){try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}function c(e,t){void 0===t&&(t={});var s=document.createElement(e);for(var r in t)t.hasOwnProperty(r)&&("style"===r?s.style.cssText=t[r]:s[r]=t[r]);return s}function u(e,t){if(Array.prototype.includes)return e.includes(t);for(var s=0;s<e.length;s++)if(e[s]===t)return!0;return!1}function d(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitSupportsFullscreen||document.webkitFullscreenEnabled||document.createElement("video").webkitRequestFullScreen)}function h(){return!!(document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)}function p(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}function m(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()}function y(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement}function f(e,t){void 0===t&&(t=!1);var s=t?"video":"audio",r="wav";if(e){var n=e.split(".").pop(),i=document.createElement("video");if("m3u8"===n)return i.canPlayType("application/x-mpegURL")?"application/x-mpegURL":"application/vnd.apple.mpegurl";switch(n){case"3gp":r="3gpp";break;case"aac":s="audio",r="aac";break;case"flac":s="audio",r="flac";break;case"m4v":case"m4p":s="video",r="mp4";break;case"mp3":s="audio",r="mp3";break;case"mp4":r="mp4";break;case"m4a":s="audio",r="mp4";break;case"mpg":case"mpeg":r="mpeg";break;case"oga":s="audio",r="ogg";break;case"ogv":s="video",r="ogg";break;case"ogg":r="ogg";break;case"mov":s="video",r="quicktime";break;case"webm":r="webm";break;case"wav":s="audio",r="wav";default:r="wav"}}return"".concat(s,"/").concat(r)}function v(e){var t=Math.floor(e/60),s=Math.floor(t/60),r=Math.floor(e%60),n=[];s>0&&n.push(String(s));var i=(t=s>0?t%60:t)<10?"0".concat(t):String(t);n.push(i);var o=r<10?"0".concat(r):"".concat(r);return n.push(o),n.join(":")}function S(){screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock()}function g(){if(screen.orientation&&screen.orientation.lock){var e=screen.orientation.lock("landscape");e&&e.then((function(){})).catch((function(e){}))}}function E(e,t){if(!e||!t)return!1;do{if(t===e)return!0;t=t.parentNode}while(t!==document);return!1}function C(e){clearTimeout(e),"default"!==document.body.style.cursor&&(document.body.style.cursor="default")}function L(){"none"!==document.body.style.cursor&&(document.body.style.cursor="none")}var b=function(){function e(){this.eventHandlers={},this.eventListeners=[]}return e.prototype.on=function(e,t){var s=this.eventHandlers;s[e]||(s[e]=[]),s[e].push(t)},e.prototype.off=function(e,t){var s=this.eventHandlers;if(s[e])if(t){var r=s[e].indexOf(t);-1!==r&&s[e].splice(r,1)}else s[e]=[]},e.prototype.trigger=function(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];var r=this.eventHandlers;if(r[e])for(var n=r[e],i=0;i<=n.length-1;i++)n[i].apply(n[i],t)},e.prototype.addEventListener=function(e,t,s){e.addEventListener(t,s),this.eventListeners.push([e,t,s])},e.prototype.removeEventListener=function(e,t,s){e.removeEventListener(t,s);for(var r=0;r<this.eventListeners.length;r++){var n=this.eventListeners[r],i=n[0],o=n[1],l=n[2];if(i===e&&o===t&&l===s){this.eventListeners.splice(r,1);break}}},e.prototype.removeAllEventListeners=function(){this.eventListeners.forEach((function(e){var t=e[0],s=e[1],r=e[2];t.removeEventListener(s,r)})),this.eventListeners.length=0},e}(),A=function(e){function s(t){var s=e.call(this)||this;for(var r in s.errorCode=0,s.errorMessage="",s.loop=!1,s.nativeControls=!1,t)s[r]="loop"===r?"one"===t[r]:t[r];return s}return t(s,e),s.prototype.setMedia=function(e){this.media=e,this.trigger("setmedia")},s.prototype.play=function(){if(this.mediaElement){var e=this.mediaElement.play();void 0!==e&&e.then((function(){})).catch((function(){}))}},s.prototype.playHead=function(e){this.mediaElement&&(this.mediaElement.currentTime=e*this.mediaElement.duration)},s.prototype.isPlaying=function(){return this.mediaElement&&!this.mediaElement.paused},s.prototype.togglePlay=function(){var e=this.mediaElement;if(!e)return!1;if(e.paused){var t=e.play();void 0!==t&&t.then((function(){})).catch((function(){}))}else e.pause()},s.prototype.stop=function(){var e=this.mediaElement;e&&(e.pause(),e.currentTime=0,this.trigger("stop"))},s.prototype.toggleLoop=function(){var e=this.mediaElement;e&&(e.loop=!e.loop),this.trigger("loopchanged")},s.prototype.pause=function(){var e=this.mediaElement;e&&e.pause()},s.prototype.pauseOthers=function(){},s.prototype.tellOthers=function(){},s.prototype.mute=function(){var e=this.mediaElement;e&&(e.muted=!0)},s.prototype.unmute=function(){var e=this.mediaElement;e&&(e.muted=!1)},s.prototype.toggleMute=function(){var e=this.mediaElement;e&&(e.muted=!e.muted)},s.prototype.volume=function(e){this.mediaElement&&(this.mediaElement.volume=e>=1?1:e)},s.prototype.clearMedia=function(){if(!this.mediaElement)return!1;this.stop(),this.mediaElement.innerHTML="",this.mediaElement.src="",this.trigger("clearmedia")},s.prototype.destroy=function(){this.clearMedia(),this.removeAllEventListeners(),this.eventHandlers={},this.mediaElement&&this.mediaElement.remove(),this.mediaElement=null,this.errorCode=0,this.errorMessage="",this.loop=!1,this.media=null,this.nativeControls=!1,this.trigger("destroy")},s.error={MEDIA_ERR_URLEMPTY:{code:-2,message:"Media playback command not possible as no media is set."},MEDIA_ERR_UNKNOWN:{code:-1,message:"An unknown error occurred."},MEDIA_ERR_ABORTED:{code:1,message:"You aborted the video playback."},MEDIA_ERR_NETWORK:{code:2,message:"A network error caused the video download to fail part-way."},MEDIA_ERR_DECODE:{code:3,message:"The video playback was aborted due to a corruption problem or because the video used features your browser did not support."},MEDIA_ERR_SRC_NOT_SUPPORTED:{code:4,message:"The video could not be loaded, either because the server or network failed or because the format is not supported."}},s}(b),x=function(e){function b(t){var n,l,a,c,u=e.call(this,t)||this;if(u.useStateClassSkin=!1,u.cssSelectorAncestor="",u.cssSelector={videoPlay:".yuan-video-play",play:".yuan-play",pause:".yuan-pause",stop:".yuan-stop",seekBar:".yuan-seek-bar",playBar:".yuan-play-bar",mute:".yuan-mute",unmute:".yuan-unmute",volumeBar:".yuan-volume-bar",volumeBarValue:".yuan-volume-bar-value",volumeMax:".yuan-volume-max",volumeValue:".yuan-volume-value",playbackRateBar:".yuan-playback-rate-bar",playbackRateBarValue:".yuan-playback-rate-bar-value",currentTime:".yuan-current-time",duration:".yuan-duration",title:".yuan-title",fullScreen:".yuan-full-screen",restoreScreen:".yuan-restore-screen",repeat:".yuan-repeat",repeatOff:".yuan-repeat-off",gui:".yuan-gui",closedCaption:".yuan-closed-caption",noSolution:".yuan-no-solution"},u.stateClass={closedCaption:"yuan-state-closed-caption",repeatOne:"yuan-repeat-one",playing:"yuan-state-playing",seeking:"yuan-state-seeking",muted:"yuan-state-muted",looped:"yuan-state-looped",fullScreen:"yuan-state-full-screen",noVolume:"yuan-state-no-volume"},u.handlePlaying=function(e){if("VIDEO"!==e.target.tagName)return!1;L(),u.debouncedHide()},u.handleVideoTouch=function(e){if(e.preventDefault(),"VIDEO"!==e.target.tagName)return!1;var t=document.querySelector(u.cssSelectorAncestor);t&&"block"!==t.style.display&&(t.style.display="block"),!1===u.isPlaying()?clearTimeout(u.debouncedHide.timer()):(L(),u.debouncedHide())},u.handleClickMedia=function(e){if("VIDEO"!==e.target.tagName)return!1;if(u.togglePlay(),!1===u.isPlaying()){var t=document.querySelector(u.cssSelectorAncestor);t&&"block"!==t.style.display&&(t.style.display="block"),C(u.cursorTimer),clearTimeout(u.debouncedHide.timer())}else L(),u.debouncedHide()},u.updateFullScreenButton=function(){var e,t,s;if(!(null===(e=u.cssSelector)||void 0===e?void 0:e.fullScreen))return!1;var r=null===(t=u.container)||void 0===t?void 0:t.querySelector(null===(s=u.cssSelector)||void 0===s?void 0:s.fullScreen);r&&d()&&(u.media&&u.isVideo(u.media)?r.style.display="inline-block":r.style.display="none")},u.handleGUIClick=function(e){var t=document.querySelector(u.cssSelectorAncestor),s=e.target;if(u.isMatchedWithSelector(s,u.cssSelector.play))u.useStateClassSkin?u.togglePlay():u.play();else if(u.isMatchedWithSelector(s,u.cssSelector.pause))u.useStateClassSkin?u.togglePlay():u.pause();else if(u.isMatchedWithSelector(s,u.cssSelector.fullScreen))u.useStateClassSkin?u.handleFullscreen():u.handleFullscreen(!0);else if(u.isMatchedWithSelector(s,u.cssSelector.stop))u.stop();else if(u.isMatchedWithSelector(s,u.cssSelector.repeat))u.stateClass.looped&&t.classList.toggle(u.stateClass.looped);else if(u.isMatchedWithSelector(s,u.cssSelector.volumeMax))u.volume(1),u.unmute();else if(u.isMatchedWithSelector(s,u.cssSelector.mute))u.useStateClassSkin?u.toggleMute():u.mute();else if(u.isMatchedWithSelector(s,u.cssSelector.unmute))u.useStateClassSkin?u.toggleMute():u.unmute();else if(u.isMatchedWithSelector(s,u.cssSelector.volumeBar)||u.isMatchedWithSelector(s,u.cssSelector.volumeBarValue)){if(u.cssSelector.volumeBar){var r=t.querySelector(u.cssSelector.volumeBar),n=e.offsetX/parseFloat(getComputedStyle(r).width);u.volume(n)}}else if((u.isMatchedWithSelector(s,u.cssSelector.seekBar)||u.isMatchedWithSelector(s,u.cssSelector.playBar))&&u.cssSelector.seekBar){var i=t.querySelector(u.cssSelector.seekBar);n=e.offsetX/parseFloat(getComputedStyle(i).width);u.playHead(n)}},u.fullscreenchangeFn=function(){var e=document.querySelector(u.cssSelectorAncestor);if(!e)return!1;var t=h(),s=y(),r=function(t){var s;void 0===t&&(t=!1),e.style.display="block",u.mediaElement.style.position="static",u.mediaElement.style.height="auto",u.mediaElement.style.left="auto",u.mediaElement.style.top="auto",clearTimeout(u.debouncedHide.timer()),u.removeEventListener(e,"mouseenter",u.fullScreenGUIHandler),u.removeEventListener(e,"mouseleave",u.hideCssAncestor),t&&(null===(s=u.mediaElement)||void 0===s||s.scrollIntoView())};if(t)return u.fullScreenElement=s,!1===E(u.container,s)?(r(!1),u.setFullscreenData(!1),!1):(e.style.display="none",u.mediaElement.style.position="fixed",u.mediaElement.style.height="100%",u.mediaElement.style.left="0",u.mediaElement.style.top="0",u.addEventListener(e,"mouseenter",u.fullScreenGUIHandler),u.addEventListener(e,"mouseleave",u.hideCssAncestor),L(),u.setFullscreenData(!0),!1);E(u.container,u.fullScreenElement)&&(r(!0),u.setFullscreenData(!1),C(u.cursorTimer)),u.fullScreenElement=null},u.handleVideoMouseMove=function(){var e=document.querySelector(u.cssSelectorAncestor);return!!e&&("block"!==e.style.display&&(e.style.display="block"),C(u.cursorTimer),!1!==u.isPlaying()&&(u.debouncedHide(),void(u.cursorTimer=setTimeout((function(){E(u.container,y())&&L()}),2e3))))},u.fullScreenGUIHandler=function(){C(u.cursorTimer),clearTimeout(u.debouncedHide.timer())},u.hideCssAncestor=function(){var e=document.querySelector(u.cssSelectorAncestor);if(!e)return!1;e.style.display="none",u.cursorTimer=setTimeout(L,2e3)},u.orientationChangeFn=function(e){!1!==u.isVideo(u.media)&&u.isPlaying()&&(L(),u.debouncedHide())},u.handleDocumentScroll=function(e){C(u.cursorTimer)},u.handleKeyboardEvents=function(e){var t,s,r,n;if("VIDEO"!==(null===(t=u.mediaElement)||void 0===t?void 0:t.tagName)||!1===isFinite(null===(s=u.mediaElement)||void 0===s?void 0:s.currentTime)||!1===isFinite(u.mediaElement.duration))return!1;" "===e.key||32===e.keyCode?u.togglePlay():"ArrowRight"===e.key||39===e.keyCode?(null===(r=u.mediaElement)||void 0===r?void 0:r.currentTime)+10<u.mediaElement.duration&&(u.mediaElement.currentTime+=10):"ArrowLeft"!==e.key&&37!==e.keyCode||(null===(n=u.mediaElement)||void 0===n?void 0:n.currentTime)-10>0&&(u.mediaElement.currentTime-=10)},u.container){u.cssSelectorAncestor=t.cssSelectorAncestor||"#yuan_container_".concat("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))),u.useStateClassSkin=!!t.useStateClassSkin,u.cssSelector=s(s({},u.cssSelector),t.cssSelector),u.stateClass=s(s({},u.stateClass),t.stateClass),u.debouncedHide=(n=function(){var e=document.querySelector(u.cssSelectorAncestor);if(!e)return!1;e.style.display="none"},l=2e3,c=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var s=this;clearTimeout(a),a=setTimeout((function(){n.call.apply(n,r([s],e,!1))}),l)},c.timer=function(){return a},c);var p=u.isVideo(t.media)&&o()||!u.isVideo(t.media)&&i();if(!u.nativeControls&&p){if(u.addSyntheticEventListeners(),u.setMedia(t.media),u.onReady(),u.cssSelectorAncestor&&u.mediaElement){var m=Math.ceil(parseFloat(getComputedStyle(u.container.querySelector(u.cssSelectorAncestor)).height)),f=u.mediaElement.parentNode;isFinite(m)&&f&&(f.style.minHeight="".concat(m,"px"))}u.addEventListeners(),u.updateFullScreenButton()}if(!p){var v=document.querySelector("".concat(u.cssSelectorAncestor," ").concat(u.cssSelector.noSolution));v&&(v.style.display="block")}}return u}return t(b,e),b.prototype.bindMediaEvents=function(){var e=this,t=this,s=this.mediaElement;if(s){var r=window.setInterval((function(){3===(null==s?void 0:s.networkState)&&(t.errorCode=A.error.MEDIA_ERR_URLEMPTY.code,t.errorMessage=A.error.MEDIA_ERR_URLEMPTY.message,clearInterval(r),t.trigger("error"))}),100);["abort","canplay","canplaythrough","durationchange","emptied","ended","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"].forEach((function(t){e.addEventListener(s,t,(function(){return e.trigger(t)}))})),this.addEventListener(s,"error",(function(e){switch(e.target.error.code){case e.target.error.MEDIA_ERR_ABORTED:t.errorCode=A.error.MEDIA_ERR_ABORTED.code,t.errorMessage=A.error.MEDIA_ERR_ABORTED.message;break;case e.target.error.MEDIA_ERR_NETWORK:t.errorCode=A.error.MEDIA_ERR_NETWORK.code,t.errorMessage=A.error.MEDIA_ERR_NETWORK.message;break;case e.target.error.MEDIA_ERR_DECODE:t.errorCode=A.error.MEDIA_ERR_DECODE.code,t.errorMessage=A.error.MEDIA_ERR_DECODE.message;break;case e.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:t.errorCode=A.error.MEDIA_ERR_SRC_NOT_SUPPORTED.code,t.errorMessage=A.error.MEDIA_ERR_SRC_NOT_SUPPORTED.message;break;default:t.errorCode=A.error.MEDIA_ERR_UNKNOWN.code,t.errorMessage=A.error.MEDIA_ERR_UNKNOWN.message}clearInterval(r),t.trigger("error")})),this.addEventListener(s,"mousemove",this.handleVideoMouseMove),this.addEventListener(s,"click",this.handleClickMedia),this.addEventListener(s,"touchstart",this.handleVideoTouch),this.addEventListener(s,"playing",this.handlePlaying)}},b.prototype.addMediaElement=function(){var e=c("div"),t=this.addMediaElementTag();this.addMediaSource(),this.setMediaPoster(),this.addTextTracks(),e.appendChild(t),this.container.insertAdjacentElement("afterbegin",e)},b.prototype.setMediaPoster=function(){var e;if(!this.mediaElement)return!1;(null===(e=this.media)||void 0===e?void 0:e.poster)&&"VIDEO"===this.mediaElement.tagName?this.mediaElement.poster=this.media.poster:this.mediaElement.removeAttribute("poster")},b.prototype.addMediaSource=function(){if(!this.media||!this.media.src||!this.mediaElement)return!1;this.mediaElement.innerHTML="",this.mediaElement.removeAttribute("src");var e=this.media.src;"string"==typeof e&&(e=[e]);for(var t=0;t<e.length;t++)this.addSourceElement(e[t],!!this.media.isVideo)},b.prototype.addTextTracks=function(){var e,t=this;if(!this.media||!1===n(this.media.tracks)||!this.mediaElement)return!1;null===(e=this.media.tracks)||void 0===e||e.forEach((function(e){var s,r,n;null===(s=t.mediaElement)||void 0===s||s.appendChild((n={default:!!(r=e).default,src:r.src,kind:r.kind||"subtitles",label:r.label},r.srclang&&(n.srclang=r.srclang),c("track",n)))}))},b.prototype.addSourceElement=function(e,t){if(void 0===t&&(t=!1),this.mediaElement){var s=c("source",{src:this.processSrc(e),type:f(e,t)});this.mediaElement.appendChild(s)}},b.prototype.processSrc=function(e){var t;if("m3u8"===e.split(".").pop()&&(!(t=document.createElement("video")).canPlayType("application/x-mpegURL")&&!t.canPlayType("application/vnd.apple.mpegURL")))if("function"==typeof Hls&&Hls.isSupported()){var s=new Hls;s.loadSource(e),s.attachMedia(this.mediaElement),this.hlsInstance=s}else console.warn("HLS is not supported in your browsers. Please make sure you are using a modern browser and/or have imported hls.js correctly.");return e},b.prototype.addMediaElementTag=function(){var e,t={preload:"metadata",controls:!!this.nativeControls,loop:void 0!==this.loop&&!!this.loop},r=s(s({},t),{style:"width: 100%; display: block;"});(null===(e=this.media)||void 0===e?void 0:e.poster)&&(r.poster=this.media.poster);var n=this.media&&this.isVideo(this.media)?c("video",r):c("audio",t);return this.mediaElement=n,n},b.prototype.isVideo=function(e){if(!e)return!1;if("boolean"==typeof e.isVideo)return e.isVideo;var t=e.src;if(!t)return!1;for(var s=["ogm","ogv","webm","mp4","m4v"],r="string"==typeof t?[t]:t.slice(0),n=0;n<r.length;n++){if(u(s,r[n].split(".").pop()))return!0}return!1},b.prototype.addSyntheticEventListeners=function(){var e=this,t=function(){var t=document.querySelector(e.cssSelectorAncestor);if(t&&e.cssSelector.seekBar&&e.stateClass.seeking){var s=t.querySelector(e.cssSelector.seekBar);null==s||s.classList.add(e.stateClass.seeking)}},s=function(){var t=document.querySelector(e.cssSelectorAncestor);if(t&&e.cssSelector.seekBar&&e.stateClass.seeking){var s=t.querySelector(e.cssSelector.seekBar);null==s||s.classList.remove(e.stateClass.seeking)}};this.on("waiting",t),this.on("seeking",t),this.on("playing",s),this.on("seeked",s),this.on("ended",(function(){if(e.stateClass.playing){var t=document.querySelector(e.cssSelectorAncestor);null==t||t.classList.remove(e.stateClass.playing)}})),this.on("durationchange",(function(){var t=document.querySelector(e.cssSelectorAncestor);if(!e.cssSelector.duration)return!1;var s=null==t?void 0:t.querySelector(e.cssSelector.duration);s&&(s.textContent=v(e.mediaElement&&isFinite(e.mediaElement.duration)?Math.floor(e.mediaElement.duration):0))})),this.on("setmedia",(function(){var t,s=e.media&&e.isVideo(e.media)?"video":"audio";if(e.mediaElement){if(e.hlsInstance&&(e.hlsInstance.detachMedia(),e.hlsInstance.destroy()),e.mediaElement.tagName.toLowerCase()!==s||e.hlsInstance){for(var r=e.mediaElement.parentNode,n=0;n<e.eventListeners.length;){var i=e.eventListeners[n],o=i[0],l=i[1],a=i[2];o===e.mediaElement?(o.removeEventListener(l,a),e.eventListeners.splice(n,1)):n++}e.clearMedia(),e.mediaElement.remove(),e.mediaElement=null,e.hlsInstance=null;var c=e.addMediaElementTag();r.insertAdjacentElement("afterbegin",c),e.bindMediaEvents()}e.addMediaSource(),e.setMediaPoster(),e.addTextTracks(),null===(t=e.mediaElement)||void 0===t||t.load()}else e.addMediaElement(),e.bindMediaEvents()})),this.on("setmedia",this.updateFullScreenButton),this.on("setmedia",(function(){var t,s,r=document.querySelector(e.cssSelectorAncestor);if(!e.cssSelector.title)return!1;var n=null==r?void 0:r.querySelector(e.cssSelector.title);n&&(n.textContent=(null===(t=e.media)||void 0===t?void 0:t.title)||""),"AUDIO"===(null===(s=e.mediaElement)||void 0===s?void 0:s.tagName)&&e.handleFullscreen(!1)})),this.on("setmedia",(function(){var t=document.querySelector(e.cssSelectorAncestor);if(!t)return!1;e.cssSelector.currentTime&&(t.querySelector(e.cssSelector.currentTime).textContent=v(0)),e.cssSelector.duration&&(t.querySelector(e.cssSelector.duration).textContent=v(0))})),this.on("setmedia",(function(){var t=document.querySelector(e.cssSelectorAncestor);t&&"block"!==t.style.display&&(t.style.display="block"),C(e.cursorTimer),clearTimeout(e.debouncedHide.timer()),e.updateVolume(),e.updateLoopState(),setTimeout((function(){e.updateCCButton()}))})),this.on("error",(function(){var t=document.querySelector(e.cssSelectorAncestor);t&&(-2!==e.errorCode&&4!==e.errorCode||(e.cssSelector.currentTime&&(t.querySelector(e.cssSelector.currentTime).textContent=v(0)),e.cssSelector.duration&&(t.querySelector(e.cssSelector.duration).textContent=v(0)),e.cssSelector.playBar&&(t.querySelector(e.cssSelector.playBar).style.width="0%")))})),this.on("timeupdate",(function(){var t=document.querySelector(e.cssSelectorAncestor);if(!t)return!1;var s=e.mediaElement?Math.floor(e.mediaElement.currentTime):0;if(e.cssSelector.currentTime&&(t.querySelector(e.cssSelector.currentTime).textContent=v(s)),e.cssSelector.playBar){var r=t.querySelector(e.cssSelector.playBar);if(r){var n=e.mediaElement&&isFinite(e.mediaElement.duration)?e.mediaElement.currentTime/e.mediaElement.duration:0;r.style.width="".concat(100*n,"%")}}})),this.on("play",(function(){var t,s=document.querySelector(e.cssSelectorAncestor);s&&e.stateClass.playing&&(null===(t=e.mediaElement)||void 0===t?void 0:t.currentSrc)&&s.classList.add(e.stateClass.playing)})),this.on("pause",(function(){var t=document.querySelector(e.cssSelectorAncestor);t&&e.stateClass.playing&&(t.classList.remove(e.stateClass.playing),t.style.display="block",clearTimeout(e.debouncedHide.timer()))})),this.on("stop",(function(){var t=document.querySelector(e.cssSelectorAncestor);t&&(e.stateClass.playing&&t.classList.remove(e.stateClass.playing),e.cssSelector.currentTime&&(t.querySelector(e.cssSelector.currentTime).textContent=v(0)),e.cssSelector.playBar&&(t.querySelector(e.cssSelector.playBar).style.width="0%"))})),this.on("clearmedia",(function(){var t=document.querySelector(e.cssSelectorAncestor);if(t&&(e.stateClass.playing&&(null==t||t.classList.remove(e.stateClass.playing)),e.cssSelector.currentTime&&(t.querySelector(e.cssSelector.currentTime).textContent=v(0)),e.cssSelector.duration&&(t.querySelector(e.cssSelector.duration).textContent=v(0)),e.cssSelector.playBar&&(t.querySelector(e.cssSelector.playBar).style.width="0%"),e.cssSelector.title)){var s=t.querySelector(e.cssSelector.title);s&&(s.textContent="")}})),this.on("volumechange",(function(){e.updateVolume()})),this.on("loopchanged",(function(){e.updateLoopState()}))},b.prototype.addEventListeners=function(){var e=document.querySelector(this.cssSelectorAncestor);if(!e)return!1;d()&&(this.addEventListener(document,"fullscreenchange",this.fullscreenchangeFn),this.addEventListener(document,"webkitfullscreenchange",this.fullscreenchangeFn),this.addEventListener(document,"mozfullscreenchange",this.fullscreenchangeFn),this.addEventListener(document,"msfullscreenchange",this.fullscreenchangeFn),this.addEventListener(document,"MSFullscreenChange",this.fullscreenchangeFn)),this.addEventListener(e,"click",this.handleGUIClick),this.addEventListener(document,"keydown",this.handleKeyboardEvents),this.addEventListener(document,"scroll",this.handleDocumentScroll),screen.orientation&&this.addEventListener(screen.orientation,"change",this.orientationChangeFn),this.updateVolume(),this.updateLoopState(),this.updateCCButton()},b.prototype.setFullscreenData=function(e){var t,s;this.stateClass.fullScreen&&(e?(this.container.classList.add(this.stateClass.fullScreen),null===(t=document.querySelector(this.cssSelectorAncestor))||void 0===t||t.classList.add(this.stateClass.fullScreen)):(this.container.classList.remove(this.stateClass.fullScreen),null===(s=document.querySelector(this.cssSelectorAncestor))||void 0===s||s.classList.remove(this.stateClass.fullScreen)))},b.prototype.handleFullscreen=function(e){var t;if(!d()){var s=document.querySelector(this.cssSelectorAncestor+" "+(null===(t=this.cssSelector)||void 0===t?void 0:t.fullScreen));return s&&(s.style.display="none"),void console.warn("Your browser does not support the Fullscreen API.")}"boolean"!=typeof e?h()?(p(),S()):(m(this.container),g()):e?(m(this.container),g()):h()&&(p(),S())},b.prototype.updateLoopState=function(){var e,t,s,r=document.querySelector(this.cssSelectorAncestor);if(!r)return!1;if(this.stateClass.looped&&((null===(e=this.mediaElement)||void 0===e?void 0:e.loop)?r.classList.add(this.stateClass.looped):r.classList.remove(this.stateClass.looped)),this.cssSelector.repeat){var n=r.querySelector(this.cssSelector.repeat);n&&(null===(t=this.stateClass)||void 0===t?void 0:t.repeatOne)&&((null===(s=this.mediaElement)||void 0===s?void 0:s.loop)?n.classList.add(this.stateClass.repeatOne):n.classList.remove(this.stateClass.repeatOne))}},b.prototype.isMatchedWithSelector=function(e,t){if(!t)return!1;do{if(a(e,t))return!0;e=e.parentNode}while(e&&e!==document.querySelector(this.cssSelectorAncestor)&&e!==document);return!1},b.prototype.updateVolume=function(){var e,t,s=document.querySelector(this.cssSelectorAncestor);if(!s)return!1;if(this.stateClass.muted&&((null===(e=this.mediaElement)||void 0===e?void 0:e.muted)?s.classList.add(this.stateClass.muted):s.classList.remove(this.stateClass.muted)),this.cssSelector.volumeValue){var r=s.querySelector(this.cssSelector.volumeValue);r&&(r.textContent=String(l(this.mediaElement?100*this.mediaElement.volume:0)))}if(!this.cssSelector.volumeBarValue)return!1;var n=s.querySelector(this.cssSelector.volumeBarValue),i=l(this.mediaElement?100*this.mediaElement.volume:0);n&&(n.style.width=(null===(t=this.mediaElement)||void 0===t?void 0:t.muted)?"0%":i+"%")},b.prototype.setActiveCC=function(e){!function(e,t){if(!e.textTracks)return!1;for(var s=0;s<e.textTracks.length;s++){var r=e.textTracks[s];r.label===t||r.language===t?r.mode="showing":r.mode="hidden"}}(this.mediaElement,e)},b.prototype.getCCList=function(){return function(e){if(!e.textTracks)return[];for(var t=[{label:"Off",checked:!0}],s=0;s<e.textTracks.length;s++){var r=e.textTracks[s];"showing"===r.mode&&(t[0].checked=!1),t.push({label:r.label||r.language,checked:"showing"===r.mode})}return t}(this.mediaElement)},b.prototype.updateCCButton=function(){var e,t,s;if(this.cssSelector.closedCaption){var r=this.container.querySelector(this.cssSelectorAncestor+" "+this.cssSelector.closedCaption);if(r)if(this.mediaElement&&"VIDEO"===(null===(e=this.mediaElement)||void 0===e?void 0:e.tagName)){var n=this.getCCList();n.length<2?r.style.display="none":(r.style.display="inline-block",this.stateClass.closedCaption&&(!0===n[0].checked?(this.container.classList.remove(this.stateClass.closedCaption),null===(t=this.container.querySelector(this.cssSelectorAncestor))||void 0===t||t.classList.remove(this.stateClass.closedCaption)):(this.container.classList.add(this.stateClass.closedCaption),null===(s=this.container.querySelector(this.cssSelectorAncestor))||void 0===s||s.classList.add(this.stateClass.closedCaption))))}else r.style.display="none"}},b}(A),k=function(e){function r(t){var r=e.call(this,t)||this;return r.cssSelectorAncestor="",r.cssSelector={item:".yuanplayer-lyric-item",noContent:".yuanplayer-lyric-empty"},r.stateClass={empty:"empty",current:"highlight"},r.cssSelectorAncestor=t.cssSelectorAncestor,r.cssSelector=s(s({},r.cssSelector),t.cssSelector),r.addEventListeners(),setTimeout((function(){r.loadLyricPlugin()}),0),r}return t(r,e),r.prototype.addEventListeners=function(){var e=this;setTimeout((function(){e.on("lyricfetched",(function(t){var s;null===(s=e.container.querySelector(e.cssSelectorAncestor))||void 0===s||(s.scrollTop=0),e._removeAllItems(),e.addLyricItems&&e.addLyricItems(t),e._updatePanel()})),e.on("timeupdated",(function(t){e.scrollLyric(t)})),e.on("reset",(function(){e._updatePanel()}))}),0)},r.prototype.scrollLyric=function(e){var t=this.getNewLyricIndex(e),s=this.lyricCurrentPosition;if(t!==s){this.lyricCurrentPosition=t;var r=this.container.querySelectorAll(this.cssSelector.item);if(r.length){r[s].classList.remove(this.stateClass.current),r[t].classList.add(this.stateClass.current);var n=r[t].offsetTop;this.container.querySelector(this.cssSelectorAncestor).scrollTop=n}}},r.prototype._removeAllItems=function(){for(var e=this.container.querySelectorAll(this.cssSelector.item),t=0;t<e.length;t++)e[t].remove()},r.prototype._updatePanel=function(){var e,t,s=0===this.lyricObj.lyricArray.length,r=this.container.querySelector(this.cssSelector.noContent);s?(this._removeAllItems(),null===(e=this.container.querySelector(this.cssSelectorAncestor))||void 0===e||e.classList.add(this.stateClass.empty)):null===(t=this.container.querySelector(this.cssSelectorAncestor))||void 0===t||t.classList.remove(this.stateClass.empty),r&&(r.style.display=s?"block":"none")},r}(function(e){function s(t){var s=e.call(this)||this;return s.lyricObj={timeArray:[],lyricArray:[]},s.lyricCurrentPosition=0,s.mediaElement=t.mediaElement,s.lyric=t.lyric,s.container=t.container,s.player=t.player,s}return t(s,e),s.prototype.parseLyricItems=function(e){for(var t=[],s=/\[[0-9]{2}:[0-9]{2}\.[0-9]{2,3}\]/g,r=0,n=e.length;r<n;r++){var i=e[r],o=i.match(s);if(o)for(var l=i.split(s).pop(),a=0,c=o.length;a<c;a++)t.push(o[a]+l)}return t},s.prototype.logLyricInfo=function(e){for(var t=/\[|\]/,s=0;s<e.length;s++){var r=e[s].split(t);r[2],this.lyricObj.timeArray.push(this.parseTimeToSeconds(r[1])),this.lyricObj.lyricArray.push(r[2])}this.trigger("lyricfetched",e)},s.prototype.compareTimeSpan=function(e,t){var s=/\[([0-9]{2}:[0-9]{2}\.[0-9]{2,3})\]/,r=e.match(s)[1],n=t.match(s)[1];return this.parseTimeToSeconds(r)-this.parseTimeToSeconds(n)},s.prototype.parseTimeToSeconds=function(e){var t=e.split("."),s=t[0].split(":"),r=parseInt(s[0]),n=parseInt(s[1]);return parseFloat(60*r+n+"."+t[1])},s.prototype.addLyric=function(){var e=this,t=this.lyric;if(t){var s=t.split(/[\n\r]/g);(s=this.parseLyricItems(s)).sort((function(t,s){return e.compareTimeSpan.call(e,t,s)})),this.lyricObj.lyricArray.length=0,this.lyricObj.timeArray.length=0,this.lyricCurrentPosition=0,this.logLyricInfo(s)}},s.prototype.bindLyricEvents=function(){var e=this,t=this.mediaElement;t&&this.player.addEventListener(t,"timeupdate",(function(){e.lyric&&e.lyricObj.timeArray.length&&e.lyricObj.lyricArray.length&&e.trigger("timeupdated",t.currentTime)}))},s.prototype.getNewLyricIndex=function(e){var t=0,s=this.lyricObj.timeArray,r=s.length;if(r){if(e<=s[0])return 0;if(e>=s[r-1])return r-1;for(var n=0;n<r;n++)if(e<=s[n]){t=n-1;break}}return t},s.prototype.loadLyricPlugin=function(){this.addLyric(),this.bindLyricEvents()},s.prototype.setLyric=function(e){this.lyric=e,this.addLyric()},s.prototype.unload=function(){this.lyric="",this.lyricObj.lyricArray.length=0,this.lyricObj.timeArray.length=0,this.lyricCurrentPosition=0,this.trigger("reset")},s.prototype.destroy=function(){this.unload(),this.removeAllEventListeners()},s}(b)),I=function(e){function s(t){var r=e.call(this)||this;return r.autoPlay=!1,r.enableRemoveControls=!1,r.shuffled=!1,r.index=0,r.originalList=[],r.list=[],r.modeIndex=0,r.container=t.container,r.modeIndex=t.loop&&s.modes.indexOf(t.loop)>-1?s.modes.indexOf(t.loop):0,r.player=t.player,r.lyricObj=t.lyricObj,r.setPlaylist(t.list),r.autoPlay=!!t.autoPlay,r.list.length&&(r.autoPlay?r.play(0):r.select(0)),r}return t(s,e),s.prototype.shuffle=function(e,t){this.player&&this.player.stop(),void 0===e?this.shuffled?this.restoreList():this.shuffleList():!0===e?this.shuffleList():this.restoreList(),this.trigger("playlistset"),t?this.play(0):this.select(0)},s.prototype.setPlaylist=function(e){this.index=0,this.shuffled=!1,this.list=r([],e,!0),this.originalList=r([],e,!0),this.trigger("playlistset"),this.list.length&&this.select(0)},s.prototype.shuffleList=function(){this.list=r([],this.originalList,!0).sort((function(){return Math.random()-.5})),this.index=0,this.shuffled=!0,this.player.isPlaying()&&this.play(),this.trigger("shuffledchanged")},s.prototype.restoreList=function(){this.list=r([],this.originalList,!0),this.index=0,this.shuffled=!1,this.player.isPlaying()&&this.play(),this.trigger("shuffledchanged")},s.prototype.add=function(e,t){void 0===t&&(t=!1),this.originalList.push(e),this.list.push(e),t?this.play(this.list.length-1):1===this.originalList.length&&this.select(0),this.trigger("add",e)},s.prototype.select=function(e){void 0===e&&(e=this.index),0<=(e=e<0?this.originalList.length+e:e)&&e<this.list.length?this.index=e:this.index=0,this.trigger("select",this.index)},s.prototype.remove=function(e){if(void 0===e)this.setPlaylist([]);else if(0<=(e=e<0?this.originalList.length+e:e)&&e<this.list.length){if(this.shuffled){var t=this.list[e];this.list.splice(e,1);for(var s=0;s<this.originalList.length;s++)if(this.originalList[s]===t){this.originalList.splice(s,1);break}}else this.list.splice(e,1),this.originalList.splice(e,1);this.originalList.length?e===this.index?(this.player.stop(),this.index=e<this.originalList.length?this.index:this.originalList.length-1,this.select(this.index)):e<this.index&&this.index--:(this.player.clearMedia(),this.lyricObj&&this.lyricObj.unload()),this.trigger("remove",e)}},s.prototype.switchModes=function(){var e=++this.modeIndex%s.modes.length;this.modeIndex=e,this.trigger("modechange")},s.prototype.setMode=function(e){if(-1===s.modes.indexOf(e))return!1;this.modeIndex=s.modes.indexOf(e),this.trigger("modechange")},s.prototype.next=function(){if(this.index===this.list.length-1)return!1;this.play(this.index+1)},s.prototype.previous=function(){if(0===this.index)return!1;this.play(this.index-1)},s.prototype.play=function(e){if(void 0===e&&(e=this.index),(e=e<0?this.originalList.length+e:e)>this.list.length-1||e<0||0===this.list.length)return!1;e!==this.index&&this.select(e),this.player&&this.player.play()},s.prototype.playAtIndex=function(e){void 0===e&&(e=this.index),this.play(e)},s.prototype.pause=function(){this.player&&this.player.pause()},s.prototype.destroy=function(){this.remove(),this.trigger("destroy")},s.modes=["off","one","all"],s}(b),M=function(e){function r(t){var r=e.call(this,t)||this;return r.cssSelectorAncestor="",r.cssSelector={remove:".yuan-playlist-item-remove",next:".yuan-next",previous:".yuan-previous",shuffle:".yuan-shuffle",item:".yuan-playlist-item"},r.stateClass={shuffled:"yuan-state-shuffled",currentItem:"yuan-playlist-current"},r.addEvents(),r.autoPlay=!!t.autoPlay,r.enableRemoveControls=!!t.enableRemoveControls,r.cssSelectorAncestor=t.cssSelectorAncestor||"",r.cssSelector=s(s({},r.cssSelector),t.cssSelector),r.stateClass=s(s({},r.stateClass),t.stateClass),null==r||r.onReady(),r._addEventListeners(),r}return t(r,e),r.prototype.addEvents=function(){var e=this;this.on("destroy",(function(){var t;e.removeAllEventListeners(),e.cssSelectorAncestor&&(null===(t=e.container.querySelector(e.cssSelectorAncestor))||void 0===t||t.remove())})),this.on("add",(function(t){e.onAdd&&e.onAdd(t)})),this.on("playlistset",(function(){e.onListUpdated()})),this.on("select",(function(t){e.updatePlayerLyric(t),e.highlightItem(t),e.updateRepeatButtonState()})),this.player.on("ended",(function(){var t=I.modes[e.modeIndex],s=-1;if("off"===t){if(e.index===e.list.length-1)return;s=e.index+1}else"one"===t?s=e.index:"all"===t&&(s=e.index===e.list.length-1?0:e.index+1);s>-1&&e.play(s)}))},r.prototype.updatePlayerLyric=function(e){if(e>this.list.length-1)return!1;this.player&&this.player.setMedia(this.list[e]),this.lyricObj&&(this.lyricObj.lyric=this.list[e].lyric,this.lyricObj&&this.lyricObj.addLyric&&this.lyricObj.addLyric())},r.prototype._addEventListeners=function(){var e=this;setTimeout((function(){e.on("shuffledchanged",(function(){var t,s;e.shuffled?(e.container.classList.add(e.stateClass.shuffled),null===(t=document.querySelector(e.player.cssSelectorAncestor))||void 0===t||t.classList.add(e.stateClass.shuffled)):(e.container.classList.remove(e.stateClass.shuffled),null===(s=document.querySelector(e.player.cssSelectorAncestor))||void 0===s||s.classList.remove(e.stateClass.shuffled))})),e.on("modechange",(function(){e.updateRepeatButtonState()})),e.highlightItem(),e.on("remove",(function(t){var s;null===(s=e.container.querySelectorAll(e.cssSelector.item||"")[t])||void 0===s||s.remove(),e.highlightItem(),e.onRemove&&e.onRemove()})),e.addEventListener(e.container,"click",(function(t){var s,r,n=t.target;if(e.isMatchedWithSelector(n,e.cssSelector.remove)){var i=e.findItemElement(n),o=e.findDomIndex(i);e.remove(o)}else if(e.isMatchedWithSelector(n,e.cssSelector.item)){i=e.findItemElement(n),o=e.findDomIndex(i);e.play(o)}else e.cssSelector.next&&a(n,null===(s=e.cssSelector)||void 0===s?void 0:s.next)?e.next():e.cssSelector.previous&&a(n,null===(r=e.cssSelector)||void 0===r?void 0:r.previous)?e.previous():e.cssSelector.shuffle&&a(n,e.cssSelector.shuffle)&&e.shuffle()})),e.updateRepeatButtonState()}),0)},r.prototype.updateRepeatButtonState=function(){var e,t,s,r,n,i;0===this.modeIndex?(null===(e=document.querySelector(this.player.cssSelectorAncestor))||void 0===e||e.classList.remove(this.player.stateClass.looped),null===(t=document.querySelector(this.player.cssSelectorAncestor))||void 0===t||t.querySelector(this.player.cssSelector.repeat).classList.remove(this.player.stateClass.repeatOne)):1===this.modeIndex?(null===(s=document.querySelector(this.player.cssSelectorAncestor))||void 0===s||s.classList.add(this.player.stateClass.looped),null===(r=document.querySelector(this.player.cssSelectorAncestor))||void 0===r||r.querySelector(this.player.cssSelector.repeat).classList.add(this.player.stateClass.repeatOne)):2===this.modeIndex&&(null===(n=document.querySelector(this.player.cssSelectorAncestor))||void 0===n||n.classList.add(this.player.stateClass.looped),null===(i=document.querySelector(this.player.cssSelectorAncestor))||void 0===i||i.querySelector(this.player.cssSelector.repeat).classList.remove(this.player.stateClass.repeatOne))},r.prototype.isMatchedWithSelector=function(e,t,s){if(void 0===s&&(s=this.container),!t)return!1;do{if(a(e,t))return!0;e=e.parentNode}while(e&&e!==s&&e!==document);return!1},r.prototype.findDomIndex=function(e){for(var t=this.container.querySelectorAll(this.cssSelector.item||""),s=0;s<t.length;s++)if(t[s]===e)return s;return 0},r.prototype.findItemElement=function(e){do{if(this.cssSelector.item&&a(e,this.cssSelector.item))return e;e=e.parentNode}while(e!==this.container&&e!==document);return null},r.prototype.highlightItem=function(e){var t,s;void 0===e&&(e=this.index),null===(t=this.container.querySelector(this.cssSelector.item+"."+this.stateClass.currentItem))||void 0===t||t.classList.remove(this.stateClass.currentItem||"");var r=this.container.querySelectorAll(this.cssSelector.item||"");r.length&&(null===(s=r[e])||void 0===s||s.classList.add(this.stateClass.currentItem||""))},r}(I),T=function(){function e(t){return new(e.use())(t)}return e.use=function(t){void 0===t&&(t={});var i={Player:t.Player?t.Player(x):x,Lyric:t.Lyric?t.Lyric(k):k,PlayList:t.PlayList?t.PlayList(M):M},o=function(){function t(t){var r,o=this;this.playerClass=i.Player,this.lyricClass=i.Lyric,this.playlistClass=i.PlayList,this.options=t,this.playerInstance=this.playerClass?new this.playerClass(s(s({},t),{media:n(t.media)&&t.media.length?t.media[0]:t.media,container:t.container})):null,this.lyricInstance=this.lyricClass?new this.lyricClass(s(s({},t),{player:this.playerInstance,lyric:n(t.media)&&t.media.length?t.media[0].lyric:(null===(r=t.media)||void 0===r?void 0:r.lyric)||"",mediaElement:this.playerInstance.mediaElement,container:t.container})):null,this.setPlaylistInstance(),["play","playHead","isPlaying","stop","toggleLoop","pause","mute","unmute","volume","clearMedia"].forEach((function(e){o[e]=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];if(o.playerInstance)return o.playerInstance[e].apply(o.playerInstance,t);console.warn("The player instance has not been initialized")}})),["loadLyricPlugin","unload","setLyric"].forEach((function(e){o[e]=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];if(o.lyricInstance)return o.lyricInstance[e].apply(o.lyricInstance,t);console.warn("The lyric instance has not been initialized")}})),["shuffle","add","select","remove","switchModes","setMode","next","previous","playAtIndex"].forEach((function(e){o[e]=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];if(o.playlistInstance)return o.playlistInstance[e].apply(o.playlistInstance,t);console.warn("The playlist instance has not been initialized")}})),e.instances.push(this)}return t.prototype.setPlaylistInstance=function(e){void 0===e&&(e=this.options),this.playlistInstance=this.playlistClass&&n(e.media)?new this.playlistClass(s(s({},e),{container:e.container,list:n(e.media)&&e.media.length?r([],e.media,!0):[],player:this.playerInstance,lyricObj:this.lyricInstance})):null},t.prototype.setMedia=function(e){this.playerInstance&&this.playerInstance.setMedia(e),this.lyricInstance&&this.lyricInstance.setLyric(e.lyric),this.playlistInstance&&(this.playlistInstance.destroy(),this.playlistInstance=null)},t.prototype.setPlaylist=function(e){var t;n(e)&&(this.playlistInstance||this.setPlaylistInstance(s(s({},this.options),{media:e})),null===(t=this.playlistInstance)||void 0===t||t.setPlaylist(e))},t.prototype.on=function(e,s){t.playerEvents.indexOf(e)>-1?this.playerInstance.on(e,s):t.lyricEvents.indexOf(e)>-1?this.lyricInstance.on(e,s):t.playlistEvents.indexOf(e)>-1&&this.playlistInstance.on(e,s)},t.prototype.off=function(e,s){t.playerEvents.indexOf(e)>-1?this.playerInstance.off(e,s):t.lyricEvents.indexOf(e)>-1?this.lyricInstance.off(e,s):t.playlistEvents.indexOf(e)>-1&&this.playlistInstance.off(e,s)},t.prototype.pauseOthers=function(){var t=this;e.instances.forEach((function(e){e!==t&&e.pause()}))},t.prototype.destroy=function(){this.playerInstance&&this.playerInstance.destroy(),this.lyricInstance&&this.lyricInstance.destroy(),this.playlistInstance&&this.playlistInstance.destroy()},t.playerEvents=["abort","canplay","canplaythrough","durationchange","emptied","ended","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","suspend","timeupdate","volumechange","waiting","error","stalled","setmedia","stop","loopchanged","clearmedia","destroy"],t.lyricEvents=["lyricfetched","timeupdated","reset"],t.playlistEvents=["shuffledchanged","add","select","remove","modechange"],t}();return o},e.instances=[],e}();return T}));
